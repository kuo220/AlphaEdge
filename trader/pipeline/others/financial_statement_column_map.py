from typing import List, Dict

"""
Balance sheet column mapping dictionary
本對照表用於清洗資產負債表欄位名稱：
- key：標準化後的統一欄位名稱（cleaned/normalized name）
- value：原始欄位可能出現的多種名稱（raw variants）
資料清洗時會將出現在 value 中的原始名稱，統一轉換為對應的 key。
"""

balance_sheet_column_map: Dict[str, List[str]] = {
    "年度": ["年度"],
    "季度": ["季度"],
    "stock_id": ["公司代號"],
    "公司名稱": ["公司名稱"],
    "資產總額": ["資產總額", "資產總計", "資產合計"],
    "負債總額": ["負債總額", "負債總計", "負債合計"],
    "權益總額": ["權益總額", "權益總計", "權益合計"],
    "保留盈餘": ["保留盈餘", "保留盈餘(或累積虧損)"],
    "不動產及設備": ["不動產及設備", "不動產及設備淨額"],
    "無形資產": ["無形資產", "無形資產淨額"],
    "再保險合約資產": ["再保險合約資產", "再保險合約資產淨額"],
    "投資性不動產": ["投資性不動產淨額", "投資性不動產投資淨額"],
    "應收款項": ["應收款項", "應收款項淨額"],
    "其他資產": ["其他資產", "其他資產淨額"],
    "其他金融資產": ["其他金融資產淨額"],
    "使用權資產": ["使用權資產", "使用權資產淨額"],
    "當期所得稅資產": ["當期所得稅資產", "本期所得稅資產"],
    "當期所得稅負債": ["當期所得稅負債", "本期所得稅負債"],
    "遞延所得稅資產": ["遞延所得稅資產"],
    "遞延所得稅負債": ["遞延所得稅負債"],
    "庫藏股": ["庫藏股", "庫藏股票"],
    "母公司持有庫藏股": [
        "母公司暨子公司持有之母公司庫藏股股數(單位:股)",
        "母公司暨子公司所持有之母公司庫藏股股數(單位:股)",
    ],
    "歸屬於母公司業主之權益總額": [
        "歸屬於母公司業主之權益總額",
        "歸屬於母公司業主權益總額",
        "歸屬於母公司業主之權益合計",
        "歸屬於母公司業主權益合計",
        "歸屬於母公司業主之權益",
    ],
    "附賣回票券及債券投資": [
        "附賣回票券及債券投資",
        "附賣回票券及債券投資淨額",
    ],
    "附買回票券及債券負債": ["附買回票券及債券負債"],
    "待出售資產": ["待出售資產", "待出售資產淨額"],
    "避險之衍生金融資產": ["避險之衍生金融資產", "避險之衍生金融資產淨額"],
    "避險之衍生金融負債": ["避險之衍生金融負債", "避險之衍生金融負債淨額"],
    "透過損益按公允價值衡量之金融資產": ["透過損益按公允價值衡量之金融資產"],
    "透過其他綜合損益按公允價值衡量之金融資產": [
        "透過其他綜合損益按公允價值衡量之金融資產"
    ],
    "透過損益按公允價值衡量之金融負債": ["透過損益按公允價值衡量之金融負債"],
    "備供出售金融資產": ["備供出售金融資產淨額"],
    "應付債券": ["應付債券"],
    "應付公司債": ["應付公司債"],
    "應付金融債券": ["應付金融債券"],
    "應付商業本票淨額": ["應付商業本票淨額"],
    "短期債務": ["短期債務"],
    "投資": ["投資"],
    "採用權益法之投資淨額": ["採用權益法之投資淨額"],
    "貼現及放款淨額": ["貼現及放款淨額"],
    "租賃負債": ["租賃負債"],
    "股本": ["股本"],
    "資本公積": ["資本公積"],
    "現金及約當現金": ["現金及約當現金"],
    "存放央行及拆借金融同業": [
        "存放央行及拆借金融同業",
        "存放央行及拆借銀行同業",
    ],
    "央行及金融同業存款": [
        "央行及金融同業存款",
        "央行及銀行同業存款",
    ],
    "央行及同業融資": ["央行及同業融資"],
    "存款": ["存款及匯款"],
    "預收股款(權益項下)之約當發行股數(單位:股)": [
        "預收股款(權益項下)之約當發行股數(單位:股)"
    ],
    "特別股負債": ["特別股負債"],
    "非流動資產": ["非流動資產"],
    "非流動負債": ["非流動負債"],
    "應付款項": ["應付款項"],
    "其他借款": ["其他借款"],
    "保險負債": ["保險負債"],
    "具金融商品性質之保險契約準備": ["具金融商品性質之保險契約準備"],
    "流動資產": ["流動資產"],
    "流動負債": ["流動負債"],
    "每股參考淨值": ["每股參考淨值"],
    "分離帳戶保險商品負債": ["分離帳戶保險商品負債"],
    "分離帳戶保險商品資產": ["分離帳戶保險商品資產"],
    "權益具證券性質之虛擬通貨": [
        "權益具證券性質之虛擬通貨",
        "權益─具證券性質之虛擬通貨",
    ],
    "受限制資產淨額": ["受限制資產淨額"],
    "待分配予業主之資產(或處分群組)": ["待分配予業主之資產(或處分群組)"],
    "待分配予業主之資產淨額": ["待分配予業主之資產淨額"],
}


comprehensive_income_column_map: Dict[str, List[str]] = {
    "公司名稱": ["公司名稱"],
    "stock_id": ["公司代號"],
    "收益": ["收益"],
    "收入": ["收入"],
    "營業收入": ["營業收入"],
    "營業成本": ["營業成本"],
    "營業毛利": ["營業毛利(毛損)"],
    "營業毛利淨額": ["營業毛利(毛損)淨額"],
    "營業費用": ["營業費用"],
    "營業利益": ["營業利益", "營業利益(損失)"],
    "營業外損益": ["營業外損益", "營業外收入及支出"],
    "支出": ["支出", "支出及費用"],
    "呆帳費用及保證責任準備提存": [
        "呆帳費用及保證責任準備提存",
        "呆帳費用及保證責任準備提存(各項提存)",
        "呆帳費用、承諾及保證責任準備提存",
    ],
    "利息以外淨損益": ["利息以外淨收益", "利息以外淨損益"],
    "利息淨收益": ["利息淨收益"],
    "淨收益": ["淨收益"],
    "所得稅利益(費用)": ["所得稅利益(費用)", "所得稅(費用)利益", "所得稅費用(利益)"],
    "稅前淨利": ["稅前淨利(淨損)"],
    "繼續營業單位稅前損益": [
        "繼續營業單位稅前淨利(淨損)",
        "繼續營業單位稅前純益(純損)",
        "繼續營業單位稅前損益",
    ],
    "繼續營業單位本期淨利": [
        "繼續營業單位本期稅後淨利(淨損)",
        "繼續營業單位本期純益(純損)",
        "繼續營業單位本期淨利(淨損)",
    ],
    "本期淨利": ["本期稅後淨利(淨損)", "本期淨利(淨損)"],
    "淨利歸屬於母公司業主": ["淨利(損)歸屬於母公司業主", "淨利(淨損)歸屬於母公司業主"],
    "淨利歸屬於非控制權益": [
        "淨利(損)歸屬於非控制權益",
        "淨利(淨損)歸屬於非控制權益",
    ],
    "淨利歸屬於共同控制下前手權益": [
        "淨利(損)歸屬於共同控制下前手權益",
        "淨利(淨損)歸屬於共同控制下前手權益",
    ],
    "本期綜合損益總額": [
        "本期綜合損益總額(稅後)",
        "本期綜合損益總額",
    ],
    "本期其他綜合損益": ["本期其他綜合損益(稅後淨額)"],
    "其他綜合損益": [
        "其他綜合損益",
        "其他綜合損益(淨額)",
        "其他綜合損益(稅後)",
    ],
    "綜合損益總額歸屬於母公司業主": ["綜合損益總額歸屬於母公司業主"],
    "綜合損益總額歸屬於非控制權益": ["綜合損益總額歸屬於非控制權益"],
    "綜合損益總額歸屬於共同控制下前手權益": ["綜合損益總額歸屬於共同控制下前手權益"],
    "已實現銷貨損益": ["已實現銷貨(損)益"],
    "未實現銷貨損益": [
        "未實現銷貨(損)益",
    ],
    "停業單位損益": ["停業單位損益"],
    "原始認列生物資產及農產品之利益": ["原始認列生物資產及農產品之利益(損失)"],
    "生物資產當期公允價值減出售成本之變動利益": [
        "生物資產當期公允價值減出售成本之變動利益(損失)"
    ],
    "合併前非屬共同控制股權綜合損益淨額": ["合併前非屬共同控制股權綜合損益淨額"],
    "合併前非屬共同控制股權損益": ["合併前非屬共同控制股權損益"],
    "每股盈餘": ["基本每股盈餘(元)"],
    "保險負債準備淨變動": ["保險負債準備淨變動"],
}


cash_flow_column_map: Dict[str, List[str]] = {
    "stock_id": [
        "公司代號",
    ],
    "公司名稱": ["公司名稱"],
    "營業活動之淨現金流入(流出)": [
        "營業活動之淨現金流入(流出)",
    ],
    "投資活動之淨現金流入(流出)": [
        "投資活動之淨現金流入(流出)",
    ],
    "籌資活動之淨現金流入(流出)": ["籌資活動之淨現金流入(流出)"],
    "匯率變動對現金及約當現金之影響": ["匯率變動對現金及約當現金之影響"],
    "本期現金及約當現金增加(減少)數": [
        "本期現金及約當現金增加(減少)數",
    ],
    "期初現金及約當現金餘額": [
        "期初現金及約當現金餘額",
    ],
    "期末現金及約當現金餘額": ["期末現金及約當現金餘額"],
}
